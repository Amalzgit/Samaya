
    <div class="container my-5">
        <h1 class="display-4 mb-5">Dashboard</h1>
        <div class="row mb-4">
            <div class="col-md-3 mb-3">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title text-muted">
                            <i class="fas fa-dollar-sign me-2"></i>Total Revenue
                        </h5>
                        <p class="card-value">
                            <%= new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR' }).format(totalRevenue) %>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title text-muted">
                            <i class="fas fa-shopping-cart me-2"></i>Total Orders
                        </h5>
                        <p class="card-value">
                            <%= totalOrders %> Nos
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title text-muted">
                            <i class="fas fa-box me-2"></i>Best Selling Product
                        </h5>
                        <p class="card-value">
                            <%= bestSellingProduct ? bestSellingProduct.name : 'N/A' %>
                        </p>
                        <p class="text-muted small">
                            Sold: <%= bestSellingProduct ? bestSellingProduct.totalSold : '0' %> Pcs
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title text-muted">
                            <i class="fas fa-folder me-2"></i>Top Category
                        </h5>
                        <p class="card-value">
                            <%= bestSellingCategory ? bestSellingCategory.name : 'N/A' %>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-lg-6 mb-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Revenue Over Time</h5>
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 mb-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Top Ten Best Selling Products</h5>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Total Sold</th>
                                    <th class="text-end">Revenue</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% topProducts.forEach(product => { %>
                                    <tr>
                                        <td><%= product.name %></td>
                                        <td><%= product.totalSold %></td>
                                        <td class="text-end">₹<%= product.revenue.toFixed(2) %></td>
                                    </tr>
                                <% }); %>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Recent Transactions</h5>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>User</th>
                            <th>Order ID</th>
                            <th>Transaction id</th>
                            <th>Payment method</th>
                            <th>Credit / Debit</th>

                            <th class="text-end">Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% latestTransactions.forEach(transaction => { %>
                            <tr>
                                <td><%= new Date(transaction.createdAt).toLocaleDateString() %></td>
                                <td><%= transaction.user ? transaction.user.email : 'N/A' %></td>
                                <td><%= transaction.order ? transaction.order.id : 'N/A' %></td>
                                <td><%= transaction.transactionNumber ? transaction.transactionNumber : 'N/A' %></td>
                                <td><%= transaction.paymentMethod ? transaction.paymentMethod : 'N/A' %></td>
                                <td><%= transaction.type ? transaction.type : 'N/A' %></td>

                                <td class="text-end">₹<%= transaction.order ? transaction.order.totalPrice.toFixed(2) : '0.00' %></td>
                            </tr>
                        <% }); %>
                    </tbody>
                </table>
                <div class="pagination-area mt-4">
                    <nav aria-label="Page navigation">
                        <ul id="pagination-controls" class="pagination justify-content-start">
                            
                        </ul>
                    </nav>
                </div>
                
            </div>
        </div>
    </div>
    <script>
        let currentPage = 1;
        const rowsPerPage = 10; // Number of rows per page
        let totalRows;
    
        document.addEventListener('DOMContentLoaded', () => {
            const rows = document.querySelectorAll('tbody tr');
            totalRows = rows.length;
            updatePagination(rows);
        });
    
        function updatePagination(rows) {
            const totalPages = Math.ceil(totalRows / rowsPerPage);
            const paginationControls = document.getElementById('pagination-controls');
            paginationControls.innerHTML = ''; // Clear existing pagination controls
    
            // Previous page button
            if (currentPage > 1) {
                paginationControls.innerHTML += `
                    <li class="page-item">
                        <a class="page-link" href="#" onclick="changePage(-1)">
                            <i class="fa fa-arrow-left"></i>
                        </a>
                    </li>
                `;
            }
    
            // Page number buttons
            for (let i = 1; i <= totalPages; i++) {
                paginationControls.innerHTML += `
                    <li class="page-item ${i === currentPage ? 'active' : ''}">
                        <a class="page-link" href="#" onclick="goToPage(${i})">${i}</a>
                    </li>
                `;
            }
    
            // Next page button
            if (currentPage < totalPages) {
                paginationControls.innerHTML += `
                    <li class="page-item">
                        <a class="page-link" href="#" onclick="changePage(1)">
                            <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                `;
            }
    
            // Update visible rows
            const start = (currentPage - 1) * rowsPerPage;
            const end = start + rowsPerPage;
    
            rows.forEach((row, index) => {
                if (index >= start && index < end) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }
    
        function changePage(direction) {
            const totalPages = Math.ceil(totalRows / rowsPerPage);
    
            currentPage += direction;
            if (currentPage < 1) {
                currentPage = 1;
            } else if (currentPage > totalPages) {
                currentPage = totalPages;
            }
    
            updatePagination(document.querySelectorAll('tbody tr'));
        }
    
        function goToPage(page) {
            currentPage = page;
            updatePagination(document.querySelectorAll('tbody tr'));
        }
    </script>
    
    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const ctx = document.getElementById('revenueChart').getContext('2d');
        const revenueChart = new Chart(ctx, {
          type: 'line', // You can change to 'bar', 'pie', etc.
          data: <%- chartData %>,
          options: {
            responsive: true,
            plugins: {
              legend: {
                position: 'top',
              },
              tooltip: {
                callbacks: {
                  label: function (tooltipItem) {
                    return `${tooltipItem.dataset.label}: ${tooltipItem.raw}`;
                  }
                }
              }
            }
          }
        });
      });
    </script>