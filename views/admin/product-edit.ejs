<section class="content-main">
    <div class="content-header">
        <div>
            <h2 class="content-title card-title">Edit Product</h2>
            <p>Edit your Product Details</p>
        </div>
    </div>
    <div class="card mb-4">
        <header class="card-header">
            <div class="row align-items-center">
                <div class="col-md-3 col-12 me-auto mb-md-0 mb-3">
                    <select class="form-select">
                        <option selected>All category</option>
                        <!-- <option>Analog Watches</option>
                        <option>Digital Watches</option>
                        <option>Mechanical Watches</option>
                        <option>Chronograph Watches</option> -->
                    </select>
                </div>
                <div class="col-md-2 col-6">
                    <input type="date" value="02.05.2022" class="form-control">
                </div>
                <div class="col-md-2 col-6">
                    <select class="form-select">
                        <option selected>Status</option>
                        <option>Active</option>
                        <option>Disabled</option>
                        <option>Show all</option>
                    </select>
                </div>
            </div>
        </header>

        <div class="card-body">
            <% if (successMessage) { %>
                <div class="alert alert-success">
                    <%= successMessage %>
                </div>
            <% } %>

            <% if (errorMessage) { %>
                <div class="alert alert-danger">
                    <%= errorMessage %>
                </div>
            <% } %>

            <form id="editProductForm" action="/admin/edit-product" method="post" enctype="multipart/form-data">
                <article class="itemlist">
                    <div class="row align-items-center">
                        <div class="col-lg-4 col-sm-4 col-8 flex-grow-1 col-name">
                            <label for="productName" class="form-label">Product Name</label>
                            <input type="text" id="productName" name="name" class="form-control" placeholder="Enter product name">
                            <div id="productNameError" class="invalid-feedback"></div>
                        </div>
                        <div class="col-lg-2 col-sm-2 col-4 col-price">
                            <label for="productPrice" class="form-label">Price</label>
                            <input type="text" id="productPrice" name="price" class="form-control" placeholder="Enter price">
                            <div id="productPriceError" class="invalid-feedback"></div>
                        </div>
                        <div class="col-lg-4 col-sm-4 col-8 flex-grow-1 col-name">
                            <label for="productDescription" class="form-label">Description</label>
                            <textarea id="productDescription" name="description" class="form-control" rows="3" placeholder="Enter product description"></textarea>
                            <div id="productDescriptionError" class="invalid-feedback"></div>
                        </div>
                        <div class="col-lg-4 col-sm-4 col-8 flex-grow-1 col-name">
                            <label for="productCategory" class="form-label">Category</label>
                            <select id="productCategory" name="category" class="form-select">
                                <option selected>Select Category</option>
                                <!-- <option>Analog Watches</option>
                                <option>Digital Watches</option>
                                <option>Mechanical Watches</option>
                                <option>Chronograph Watches</option> -->
                            </select>
                            <div id="productCategoryError" class="invalid-feedback"></div>
                        </div>
                        <div class="col-lg-4 col-sm-4 col-8 flex-grow-1 col-name">
                            <label for="productStatus" class="form-label">Status</label>
                            <select id="productStatus" name="status" class="form-select">
                                <option selected>Select Status</option>
                                <option>Active</option>
                                <option>Disabled</option>
                            </select>
                            <div id="productStatusError" class="invalid-feedback"></div>
                        </div>
                        <div class="col-lg-4 col-sm-4 col-8 flex-grow-1 col-name">
                            <label for="productDeleted" class="form-label">Deleted</label>
                            <select id="productDeleted" name="deleted" class="form-select">
                                <option selected>No</option>
                                <option>Yes</option>
                            </select>
                            <div id="productDeletedError" class="invalid-feedback"></div>
                        </div>
                        <div class="col-lg-4 col-sm-4 col-8 flex-grow-1 col-name">
                            <label for="productImage" class="form-label">Product Image</label>
                            <input type="file" id="productImage" multiple name="images" class="form-control">
                            <div id="productImageError" class="invalid-feedback"></div>
                        </div>
                    </div>
                </article>
                <div class="row align-items-center mt-3">
                    <div class="col-lg-12 col-sm-12 col-12 text-end">
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>

<script>
    document.addEventListener("DOMContentLoaded", () => {

        const nameInput = document.getElementById('productName');
        const priceInput = document.getElementById('productPrice');
        const descriptionInput = document.getElementById('productDescription');
        const categoryInput = document.getElementById('productCategory');
        const statusInput = document.getElementById('productStatus');
        const deletedInput = document.getElementById('productDeleted');
        const imageInput = document.getElementById('productImage');

        const nameError = document.getElementById('productNameError');
        const priceError = document.getElementById('productPriceError');
        const descriptionError = document.getElementById('productDescriptionError');
        const categoryError = document.getElementById('productCategoryError');
        const statusError = document.getElementById('productStatusError');
        const deletedError = document.getElementById('productDeletedError');
        const imageError = document.getElementById('productImageError');

        const validateName = () => {
            if (nameInput.value.trim() === '') {
                nameError.textContent = '* Product name is required';
                return false;
            } else {
                nameError.textContent = '';
                return true;
            }
        };

        const validatePrice = () => {
            const priceRegex = /^[0-9]+(\.[0-9]{1,2})?$/;
            if (priceInput.value.trim() === '') {
                priceError.textContent = '* Price is required';
                return false;
            } else if (!priceRegex.test(priceInput.value.trim())) {
                priceError.textContent = '* Enter a valid price';
                return false;
            } else {
                priceError.textContent = '';
                return true;
            }
        };

        const validateDescription = () => {
            if (descriptionInput.value.trim() === '') {
                descriptionError.textContent = '* Description is required';
                return false;
            } else {
                descriptionError.textContent = '';
                return true;
            }
        };

        const validateCategory = () => {
            if (categoryInput.value === 'Select Category') {
                categoryError.textContent = '* Category is required';
                return false;
            } else {
                categoryError.textContent = '';
                return true;
            }
        };

        const validateStatus = () => {
            if (statusInput.value === 'Select Status') {
                statusError.textContent = '* Status is required';
                return false;
            } else {
                statusError.textContent = '';
                return true;
            }
        };

        const validateDeleted = () => {
            if (deletedInput.value === 'Select') {
                deletedError.textContent = '* Deleted status is required';
                return false;
            } else {
                deletedError.textContent = '';
                return true;
            }
        };

        const validateImages = () => {
            if (imageInput.files.length === 0) {
                imageError.textContent = '* At least one image is required';
                return false;
            } else {
                imageError.textContent = '';
                return true;
            }
        };

        nameInput.addEventListener('input', validateName);
        priceInput.addEventListener('input', validatePrice);
        descriptionInput.addEventListener('input', validateDescription);
        categoryInput.addEventListener('change', validateCategory);
        statusInput.addEventListener('change', validateStatus);
        deletedInput.addEventListener('change', validateDeleted);
        imageInput.addEventListener('change', validateImages);

        const form = document.getElementById('editProductForm');

        form.addEventListener('submit', (event) => {
            if (!validateName() || !validatePrice() || !validateDescription() || !validateCategory() || !validateStatus() || !validateDeleted() || !validateImages()) {
                event.preventDefault();
            }
        });
    });
</script>
